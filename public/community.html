<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="./leaf-solid.svg" type="image/x-icon">
  <title>Community - Life Swap</title>
  <link rel="stylesheet" href="./css/community.css">
  <link rel="stylesheet" href="./css/customHeader.css">
  <link rel="stylesheet" href="./css/chat.css">
  <link href="https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"></script>
</head>
<body>
  <div class="community-page">
    <div class="top-bar">
      <a href="./start.html" class="button-link">Go back</a>
      <div class="community-info">
        <h2 id="communityName"></h2>
        <p id="communityMeta">Created: <span id="createdAt"></span> by <span id="creatorName"></span></p>
        <h3 class="life-swap"><i class="fa-solid fa-leaf" style="font-size: 20px; color: rgba(172, 255, 47, 0.881);"></i> <span style="color: rgba(172, 255, 47, 0.742);">Life</span> Swap. No money, just value.<br/> <a href="#" style="text-decoration: none; color: rgb(255, 255, 255); text-decoration: underline;">Donate</a> üíô</h3>
      </div>
      <button id="viewCommunitiesBtn">Your Communities</button>
      <button id="viewNotificationsBtn">üîî Notifications <span id="notificationCount" class="notification-badge"></span></button>
    </div>
    <p id="communityId"></p>
    <button class="copy-btn" id="copyCommunityIdBtn">Copy Community ID</button>
    <p style="color: #fff; text-align: center;">Total Users: <span id="totalUsers">0</span> | Banned Users: <span id="bannedUsers">0</span> | <span id="profileRequestsBtn"></span></p>
    <div id="userSwapInfo" class="user-swap-info">
      Username: <span id="userNameCopy" class="clickable">‚è≥ Loading...</span> | ü§ù Your Swaps: <span id="swapCount">0</span>
    </div>
    <div class="community-page">
    <h3>Menu</h3>
    <div id="communityActions"></div>

    <!-- New Post Form (Toggle) -->
    <details>
      <summary>New Post </summary>
      <div>
        <form id="newPostForm">
          <label>Title</label>
          <input type="text" id="postTitle" placeholder="Title" required>
          <label>Description</label>
          <textarea id="postDescription" placeholder="Description" required></textarea>
          <label for="category">Category (For your item/skill/time):</label>
          <select id="category" required>
            <option value="" disabled selected>Select Category</option>
            <option value="clothing_accessories">Clothing & Accessories</option>
            <option value="electronics">Electronics & Gadgets</option>
            <option value="furniture_decor">Furniture & Home Decor</option>
            <option value="kitchen_dining">Kitchen & Dining</option>
            <option value="tools_diy">Tools & DIY</option>
            <option value="books_media">Books, Movies & Music</option>
            <option value="arts_crafts">Arts & Crafts</option>
            <option value="toys_games">Toys & Games</option>
            <option value="sports_outdoors">Sports & Outdoors</option>
            <option value="health_beauty">Health & Beauty</option>
            <option value="baby_kids">Baby & Kids</option>
            <option value="pet_supplies">Pet Supplies</option>
            <option value="misc">Miscellaneous</option>
          </select>
          <label>Photos (Up to 5):</label>
          <input type="file" id="postPhotos" multiple accept="image/*">
          <label>Location:</label>
          <input type="text" id="postLocation" placeholder="Location" required>
          <div id="postLocationSuggestions" class="suggestions"></div>
          <p style="color: orange; font-size: 0.9em"><em>*You need to click in one of the suggestions</em></p>
          <div class="community-checkbox-container">
            <label>Post to Communities:</label>
            <div id="communityCheckboxes" class="community-checkboxes">
              <!-- Checkboxes populated dynamically -->
            </div>
          </div>
          <label for="lookingFor">What are you looking for?</label>
          <select id="lookingFor" required>
            <option value="">Select an option</option>
            <option value="Time">Time</option>
            <option value="Skill">Skill</option>
            <option value="Item">Item</option>
          </select>
          <label for="offering">What are you offering?</label>
          <select id="offering" required>
            <option value="">Select an option</option>
            <option value="Time">Time</option>
            <option value="Skill">Skill</option>
            <option value="Item">Item</option>
          </select>
          <br/><br/>
          <button type="button" id="createPostBtn">Create Post</button>
        </form>
      </div>
    </details>

    <!-- Your Posts (Toggle) -->
    <div id="scroll-to-ur-posts"></div>
    <details>
      <summary>Your Posts</summary>
      <div id="yourPostsList"></div>
    </details>

    <!-- Community Posts Carousel -->
<div id="postsCarousel" class="posts-carousel">
  <h3>Trending Posts <span>üî•</span></h3>
  <button class="carousel-arrow prev" id="carouselPrevBtn">&lt;</button>
  <div class="carousel-track" id="carouselTrack">
    <!-- Posts populated dynamically -->
  </div>
  <button class="carousel-arrow next" id="carouselNextBtn">&gt;</button>
</div>

    <div id="scroll-down-posts"></div>
    <!-- Community Posts -->
    <div id="posts">
      <h3>Community Posts</h3>
      <div class="post-filter-bar">
        <label for="categoryFilter">Category:</label>
        <select id="categoryFilter">
          <option value="">All</option>
          <option value="clothing_accessories">Clothing & Accessories</option>
          <option value="electronics">Electronics & Gadgets</option>
          <option value="furniture_decor">Furniture & Home Decor</option>
          <option value="kitchen_dining">Kitchen & Dining</option>
          <option value="tools_diy">Tools & DIY</option>
          <option value="books_media">Books, Movies & Music</option>
          <option value="arts_crafts">Arts & Crafts</option>
          <option value="toys_games">Toys & Games</option>
          <option value="sports_outdoors">Sports & Outdoors</option>
          <option value="health_beauty">Health & Beauty</option>
          <option value="baby_kids">Baby & Kids</option>
          <option value="pet_supplies">Pet Supplies</option>
          <option value="misc">Miscellaneous</option>
        </select>
        <label for="lookingForFilter">Looking For:</label>
        <select id="lookingForFilter">
          <option value="">All</option>
          <option value="Time">Time</option>
          <option value="Skill">Skill</option>
          <option value="Item">Item</option>
        </select>
        <label for="offeringFilter">Offering:</label>
        <select id="offeringFilter">
          <option value="">All</option>
          <option value="Time">Time</option>
          <option value="Skill">Skill</option>
          <option value="Item">Item</option>
        </select>
      </div>
      <div class="search-bar">
        <input type="text" id="postSearch" placeholder="Search by Post ID...">
        <button type="button" id="pasteSearchBtn" title="Paste from clipboard">Paste</button>
        <button type="button" id="clearSearchBtn" title="Clear search">Clear</button>
      </div>
      <div id="search-scrolldown"></div>
      <button id="refreshPostsBtn">Refresh Posts üîÑ</button>
      <div id="postList"></div>
      <div id="caughtUpMessage" class="caught-up" style="display: none;">You are all caught up!</div>
      <div id="sentinel" style="height: 1px;"></div>
      <div class="pagination" id="postPagination"></div>
    </div>
    <div id="search-scrolldown2"></div>

  <!-- View Profile Modal -->
  <div id="viewProfileModal" class="modal hidden">
    <div class="modal-content">
      <h2 id="profileName"></h2>
      <img loading="lazy" id="profilePhoto" src="" class="profile-photo" alt="Profile">
      <div id="profileDetails"></div>
      <div id="profileActions"></div>
      <button id="closeProfileBtn">Close</button>
    </div>
  </div>

  <!-- View Members Modal -->
  <div id="viewMembersModal" class="modal hidden">
    <div class="modal-content">
      <h2>Members</h2>
      <input type="text" id="memberSearch" placeholder="Search members...">
      <div id="membersList" class="user-list"></div>
      <button id="closeMembersBtn">Close</button>
    </div>
  </div>

  <!-- View Banned Users Modal -->
  <div id="viewBannedModal" class="modal hidden">
    <div class="modal-content">
      <h2>Banned Users</h2>
      <input type="text" id="bannedSearch" placeholder="Search banned users...">
      <div id="bannedList" class="user-list"></div>
      <button id="closeBannedBtn">Close</button>
    </div>
  </div>

  <!-- View Profile View Requests Modal -->
  <div id="viewProfileViewRequestsModal" class="modal hidden">
    <div class="modal-content">
      <h2>Profile View Requests</h2>
      <div id="profileViewRequestsList" class="user-list"></div>
      <h2>Granted Profile Access</h2>
      <div id="grantedProfileAccessList" class="user-list"></div>
      <button id="closeProfileViewRequestsBtn">Close</button>
    </div>
  </div>

  <!-- Saved Posts Modal -->
<div id="viewSavedPostsModal" class="modal hidden">
  <div class="modal-content">
    <h2>Saved Posts üíô</h2>
    <div id="savedPostsList" class="user-list"></div>
    <button id="closeSavedPostsBtn">Close</button>
  </div>
</div>

<!-- Save Post Modal -->
<div id="savePostModal" class="modal hidden">
  <div class="modal-content">
    <h2>Save Post</h2>
    <p>Write a short note for yourself (optional):</p>
    <textarea id="savePostNote" maxlength="200" placeholder="e.g., 'Cool item for later'"></textarea>
    <button id="confirmSavePostBtn">Save</button>
    <button id="cancelSavePostBtn">Cancel</button>
  </div>
</div>

  <!-- View Communities Modal -->
<div id="viewCommunitiesModal" class="modal hidden">
  <div class="modal-content">
    <h2>Your Communities</h2>
    <div id="communitiesList" class="user-list"></div>
    <button id="closeCommunitiesBtn">Close</button>
  </div>
</div>

<!-- Delete Post Confirmation Modal -->
<div id="deletePostModal" class="modal hidden">
  <div class="modal-content">
    <h2>Reason for Deleting Post</h2>
    <button id="swappedBtn">I swapped it</button>
    <button id="justDeleteBtn">Just delete it</button>
    <div id="swapDetails" class="hidden">
      <p>Who did you swap with?</p>
      <p>Remember: Ask the person you swapped their username</p>
      <input type="text" id="swapUsername" placeholder="Enter username">
      <button id="validateSwapBtn">Validate</button>
      <p id="swapValidationResult" style="color: red;"></p>
      <p id="swapConfirmed" class="hidden">Swapped with: <span id="swapPartner"></span> <button id="editSwapBtn">Edit</button></p>
      <button id="proceedSwapBtn" class="hidden">Proceed</button>
    </div>
    <div id="swapSuccess" class="hidden">
      <p id="swapSuccessMessage"></p>
      <form action="https://www.paypal.com/donate" method="post" target="_blank">
        <input type="hidden" name="business" value="YOUR_PAYPAL_EMAIL_OR_ID">
        <input type="hidden" name="currency_code" value="USD">
        <button type="submit" id="donateBtn">Tip Us via PayPal</button>
      </form>
    </div>
    <button id="closeDeleteModalBtn">Cancel</button>
    <!-- Added Loading Overlay -->
    <div id="loadingOverlay" class="hidden">
      <div class="loading-spinner"></div>
      <p>‚è≥ Deleting...</p>
    </div>
  </div>
</div>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="loading-overlay hidden">
  <div class="loading-text">‚è≥ Deleting...</div>
</div>

<!-- Notifications Modal -->
<div id="notificationsModal" class="modal hidden">
  <div class="modal-content">
    <h2>üîî Notifications <span id="modalNotificationCount">0</span></h2>
    <div class="notifications-filter">
      <label for="communityFilter">Filter by Community:</label>
      <select id="communityFilter">
        <option value="all">All Communities</option>
        <!-- Options populated dynamically -->
      </select>
      <button id="goToCommunityBtn" style="display: none;">Go to Community</button>
    </div>
    <div id="notificationList" class="notification-list"></div>
    <button id="clearNotificationsBtn">Clear Notifications</button>
    <button id="closeNotificationsBtn">Close</button>
  </div>
</div>

<!-- Update viewFollowersModal -->
<div id="viewFollowersModal" class="modal hidden">
  <div class="modal-content">
    <div class="tabs">
      <button id="followersTab" class="tab-button active">Followers</button>
      <button id="followingTab" class="tab-button">Following</button>
    </div>
    <input type="text" id="followerSearch" placeholder="Search...">
    <div id="followersList"></div>
    <button id="closeFollowersBtn">Close</button>
  </div>
</div>

<!-- New User Activities Modal -->
<div id="userActivitiesModal" class="modal hidden">
  <div class="modal-content">
    <h2>user communities</h2>
    <div id="activitiesList"></div>
    <button id="closeActivitiesBtn">Close</button>
  </div>
</div>

  <!-- Autocomplete Suggestions for @ Tagging -->
  <div id="tagSuggestions" class="suggestions hidden"></div>


  <div id="delete-status">Ready to delete...</div>

  <script type="module" src="./js/chat.js"></script>
  <script type="module" src="./js/customHeader.js"></script>
  <script type="module" src="./js/followersManager.js"></script>
  <script type="module" src="./js/profileManager.js"></script>
  <script type="module" src="./js/banManager.js"></script>
  <script type="module" src="./js/commentsReplies.js"></script>
  <script type="module" src="./js/main.js"></script>
  <script src="./js/footer.js"></script>
</body>
</html>